/*!
 * jQuery Peelback
 * Copyright 2011, Rob Flaherty
 *
 * Dual licensed under the MIT and GPL licenses
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */(function(e){e.Peelback=function(t,n){var r=this;r.$el=e(t);r.el=t;r.$el.data("Peelback",r);r.init=function(){var t,i,s,o,u,a,f;r.settings=e.extend({},e.Peelback.defaultSettings,n);if(typeof r.settings.adImage!="string"||r.settings.adImage===""){r.settings.debug===!0&&console.log("Ad image missing");return}if(typeof r.settings.peelImage!="string"||r.settings.peelImage===""){r.settings.debug===!0&&console.log("Peel effect image missing");return}if(typeof r.settings.clickURL!="string"||r.settings.clickURL===""){r.settings.debug===!0&&console.log("Click URL missing");return}o=r.settings.smallSize+"px";u=r.settings.bigSize+"px";a=r.settings.smallSize-3+"px";f=Math.floor(r.settings.bigSize*.96)+"px";t=e('<div id="peelback"><a href="'+r.settings.clickURL+'" target="_blank"><img src="'+r.settings.peelImage+'" alt="" border="0" /></a><div></div></div>');i=t.find("img");s=t.find("div");e(i).css({width:"0",height:"0","z-index":"9001",position:"absolute",right:"0",top:"0","-ms-interpolation-mode":"bicubic"});e(s).css({width:"0",height:"0",overflow:"hidden",position:"absolute",right:"0",top:"0","z-index":"9000",background:"url("+r.settings.adImage+") no-repeat right top"});r.$el.prepend(t);if(r.settings.autoAnimate===!1){e(i).css({width:o,height:o});e(s).css({width:a,height:a})}else{e(i).delay(500).animate({width:o,height:o},500);e(s).delay(500).animate({width:a,height:a},500)}t.hover(function(){e(i).stop().animate({width:u,height:u},500);e(s).stop().animate({width:f,height:f},500);r.settings.gaTrack===!0&&(typeof _gaq!="undefined"?_gaq.push(["_trackEvent","Ad_Interaction","Peelback",r.settings.gaLabel]):r.settings.debug===!0&&console.log("Google Analytics _gaq object undefined"))},function(){e(i).stop().animate({width:o,height:o},400);e(s).stop().animate({width:a,height:a},400)})};r.init()};e.Peelback.defaultSettings={adImage:null,peelImage:null,clickURL:null,smallSize:58,bigSize:510,gaTrack:!1,gaLabel:"default",autoAnimate:!0,debug:!1};e.fn.peelback=function(t){return this.each(function(){new e.Peelback(this,t)})}})(jQuery);